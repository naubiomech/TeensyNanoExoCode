% number of weights, kg, reading
calibration_data = [ 12, 15,    745;...
                    11, 13.89,	742;...
                    10, 12.78,  738;...
                    9,  11.66,  736;...
                    8,  10.55,  732;...
                    7,  9.44,   729;...
                    6,  8.33,   725;...
                    5,  7.22,   722;...
                    4,  6.1,    718;...
                    3,  4.99,   715;...
                    2,  3.88,   712;...
                    1,  2.77,   708;...
                    0,  1.66,   705];
% confirm linearity      
figure;
plot(calibration_data(:,2),calibration_data(:,3));
xlabel("load (kg)");
ylabel("reading");
%%
% torque comand, reading, measured torque
validation_data = [ 0.00,	699.65,	-0.09;...
                    0.50,	699.50,	-0.12;...
                    1.00,	703.19,	0.73;...
                    1.50,	704.42,	1.01;...
                    2.00,	706.69,	1.53;...
                    2.50,	710.17,	2.32;...
                    3.00,	711.30,	2.58;...
                    3.50,	713.13,	3.00;...
                    4.00,	716.45,	3.76;...
                    4.50,	717.30,	3.96;...
                    5.00,	719.22,	4.40;...
                    5.50,	722.64,	5.18;...
                    6.00,	724.03,	5.50;...
                    6.50,	726.16,	5.99;...
                    7.00,	727.15,	6.21;...
                    7.50,	728.50,	6.52;...
                    8.00,	728.87,	6.61;...
                    7.50,	728.63,	6.55;...
                    7.00,	728.26,	6.47;...
                    6.50,	727.96,	6.40;...
                    6.00,	727.37,	6.26;...
                    5.50,	726.55,	6.08;...
                    5.00,	725.59,	5.86;...
                    4.50,	724.26,	5.55;...
                    4.00,	723.36,	5.35;...
                    3.50,	720.44,	4.68;...
                    3.00,	718.37,	4.20;...
                    2.50,	712.85,	2.94;...
                    2.00,	711.89,	2.72;...
                    1.50,	710.57,	2.42;...
                    1.00,	704.72,	1.08;...
                    0.50,	704.37,	0.99;...
                    0.00,	699.85,	-0.04];

figure;                
plot(1:size(validation_data,1),validation_data(:,1),1:size(validation_data,1),validation_data(:,3)); 
legend("cmd (Nm)", "measured (Nm)");
xlabel("measurement number");
ylabel("Torque (Nm)");
figure;                
plot(validation_data(:,1),validation_data(:,3)-validation_data(:,1)); 
xlabel("Command (Nm)");
ylabel("Error (Nm)"); 
%%
% This method used a pully to redirect the cable.  
% This may contribute to some of the high torque error                
% 
% Resolution is 0.229 Nm per count 
% (15 kg - 1.66 kg)/(745 count - 705 count) * 0.07 m * 9.81 m/s
                
                